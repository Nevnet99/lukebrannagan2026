---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/Base.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../../consts";

// Get all blog posts and sort by date (newest first)
const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<BaseLayout title={`Blog | ${SITE_TITLE}`} description={SITE_DESCRIPTION}>
  <section>
    <h1 class="text-4xl font-bold mb-8">Blog</h1>
    <ul class="space-y-4">
      {
        posts.map((post) => (
          <li class="border-b border-gray-200 pb-4 last:border-0 dark:border-gray-700">
            <a href={`/blog/${post.id}/`} class="group block">
              <h2 class="text-2xl font-semibold group-hover:text-primary group-hover:underline transition-colors">
                {post.data.title}
              </h2>
              <p class="text-gray-500 dark:text-gray-400 text-sm mb-2">
                {post.data.pubDate.toLocaleDateString("en-us", {
                  year: "numeric",
                  month: "short",
                  day: "numeric",
                })}
              </p>
              <p class="text-gray-700 dark:text-gray-300">
                {post.data.description}
              </p>
            </a>
          </li>
        ))
      }
    </ul>
  </section>
</BaseLayout>
