---
import { type CollectionEntry, getCollection, render } from "astro:content";
import Base from "../../layouts/Base.astro";
import { SITE_TITLE } from "../../consts";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.id },
    props: post,
  }));
}

type Props = CollectionEntry<"blog">;

const post = Astro.props;
const { Content } = await render(post);
---

<Base
  title={`${post.data.title} | ${SITE_TITLE}`}
  description={post.data.description}
  image={post.data.heroImage.src
    ? { src: post.data.heroImage.src, alt: post.data.title }
    : undefined}
>
  <article class="max-w-3xl mx-auto px-4 py-12">
    {/* Header Section */}
    <div class="mb-8 text-center">
      {
        post.data.heroImage && (
          <div class="mb-8 rounded-lg overflow-hidden shadow-sm">
            <img
              src={post.data.heroImage}
              alt={post.data.title}
              class="w-full h-auto object-cover"
            />
          </div>
        )
      }

      <div
        class="text-gray-500 dark:text-gray-400 mb-4 text-sm font-medium uppercase tracking-wider"
      >
        <time datetime={post.data.pubDate.toISOString()}>
          {
            post.data.pubDate.toLocaleDateString("en-us", {
              year: "numeric",
              month: "long",
              day: "numeric",
            })
          }
        </time>
      </div>
      <h1
        class="text-4xl md:text-5xl font-bold tracking-tight mb-4 text-gray-900 dark:text-white"
      >
        {post.data.title}
      </h1>
      <hr class="border-gray-200 dark:border-gray-800 mt-8 w-24 mx-auto" />
    </div>

    <div
      class="prose prose-lg dark:prose-invert mx-auto hover:prose-a:text-blue-600 prose-img:rounded-lg"
    >
      <Content />
    </div>
  </article>
</Base>
